# credential-code-utility for Java

A Java utility library for decrypting credentials from `.creds` files generated by `credential-code`.

## Requirements

- Java 11 or higher
- org.json library for JSON parsing

## Installation

### Maven

Add the dependency manually after building:

```bash
cd path/to/credential-code/utilities/java
mvn clean install
```

Then add to your project's pom.xml:

```xml
<dependency>
    <groupId>com.credentialcode</groupId>
    <artifactId>credential-code-utility</artifactId>
    <version>0.1.0</version>
</dependency>
```

### Manual integration

1. Copy `CredentialDecryptor.java` to your project
2. Add the org.json dependency to your project:

```xml
<dependency>
    <groupId>org.json</groupId>
    <artifactId>json</artifactId>
    <version>20231013</version>
</dependency>
```

## Usage

### Basic usage

```java
import com.credentialcode.utility.CredentialDecryptor;
import java.nio.file.Paths;
import java.util.Map;

// Initialize with key file path
CredentialDecryptor decryptor = new CredentialDecryptor(
    Paths.get(".credential-code/encryption-key.txt")
);

// Load all credentials from .creds file
Map<String, String> credentials = decryptor.loadCredentials("Generated/credentials.creds");

// Access individual credentials
String apiKey = credentials.get("API_KEY");
System.out.println("API Key: " + apiKey);
```

### Alternative initialization

```java
// With base64-encoded key string
CredentialDecryptor decryptor = new CredentialDecryptor("your-base64-encoded-key");

// With byte array
byte[] keyBytes = Base64.getDecoder().decode("your-base64-encoded-key");
CredentialDecryptor decryptor2 = new CredentialDecryptor(keyBytes);

// With File object
File keyFile = new File(".credential-code/encryption-key.txt");
CredentialDecryptor decryptor3 = new CredentialDecryptor(keyFile);
```

### Convenience methods

```java
// Using default key path (.credential-code/encryption-key.txt)
Map<String, String> credentials = CredentialDecryptor.loadCredentials(
    "Generated/credentials.creds"
);

// Using custom key path
Map<String, String> credentials2 = CredentialDecryptor.loadCredentials(
    "Generated/credentials.creds",
    "path/to/custom/key.txt"
);
```

### Loading from JSON

```java
// From JSON string
String jsonContent = Files.readString(Paths.get("credentials.creds"));
Map<String, String> credentials = decryptor.loadCredentialsFromJson(jsonContent);

// From JSONObject
JSONObject credsData = new JSONObject(jsonContent);
Map<String, String> credentials2 = decryptor.loadCredentialsFromJson(credsData);
```

### Error handling

```java
try {
    Map<String, String> credentials = CredentialDecryptor.loadCredentials(
        "Generated/credentials.creds"
    );
} catch (IOException e) {
    System.err.println("Failed to read file: " + e.getMessage());
} catch (Exception e) {
    System.err.println("Failed to decrypt credentials: " + e.getMessage());
}
```

## Building

```bash
# Using Maven
mvn clean compile

# Or compile directly
javac -cp ".:json-20231013.jar" CredentialDecryptor.java
```