# credential-code-utility for JavaScript/TypeScript

A JavaScript/TypeScript utility library for decrypting credentials from `.creds` files generated by `credential-code`.

## Installation

### From source

```bash
cd path/to/credential-code/utilities/javascript
npm install
npm link  # Optional: make it available globally
```

### Manual integration

Simply copy `index.js` (and `index.d.ts` for TypeScript) to your project.

## Requirements

- Node.js >= 12.0.0
- No external dependencies (uses Node.js built-in crypto module)

## Usage

### JavaScript

```javascript
const { CredentialDecryptor, loadCredentials } = require('credential-code-utility');

// Method 1: Using the CredentialDecryptor class
const decryptor = new CredentialDecryptor('.credential-code/encryption-key.txt');
const credentials = decryptor.loadCredentials('Generated/credentials.creds');

console.log('API Key:', credentials.API_KEY);

// Method 2: Using the convenience function
const creds = loadCredentials('Generated/credentials.creds');
console.log('Database URL:', creds.DATABASE_URL);
```

### TypeScript

```typescript
import { CredentialDecryptor, loadCredentials } from 'credential-code-utility';

// With type safety
const decryptor = new CredentialDecryptor('.credential-code/encryption-key.txt');
const credentials: Record<string, string> = decryptor.loadCredentials('Generated/credentials.creds');

const apiKey: string = credentials.API_KEY;
```

### Alternative initialization

```javascript
// With base64-encoded key string
const decryptor = new CredentialDecryptor('your-base64-encoded-key');

// With Buffer
const keyBuffer = Buffer.from('your-base64-encoded-key', 'base64');
const decryptor2 = new CredentialDecryptor(keyBuffer);

// Using convenience function with options
const credentials = loadCredentials('Generated/credentials.creds', {
    keyPath: 'path/to/custom/key.txt'
});

// Or with base64 key
const credentials2 = loadCredentials('Generated/credentials.creds', {
    keyBase64: 'your-base64-encoded-key'
});
```

### Loading from JSON data

```javascript
// From JSON string
const jsonString = fs.readFileSync('credentials.creds', 'utf8');
const credentials = decryptor.loadCredentialsFromJson(jsonString);

// From parsed JSON object
const credsData = JSON.parse(jsonString);
const credentials2 = decryptor.loadCredentialsFromJson(credsData);
```

## Error Handling

```javascript
try {
    const credentials = loadCredentials('Generated/credentials.creds');
} catch (error) {
    console.error('Failed to load credentials:', error.message);
}
```